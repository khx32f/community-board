# 커뮤니티 게시판 — 관리자 매뉴얼

> 관리자 권한으로 게시판을 운영하는 방법을 설명합니다.

---

## 1. 관리자 권한 부여

관리자 권한은 데이터베이스에서 직접 설정합니다.

### 방법: Supabase Dashboard 사용

1. [Supabase Dashboard](https://supabase.com/dashboard) 접속 후 본인 프로젝트 선택
2. **SQL Editor** 메뉴 선택
3. 아래 SQL 실행 (사용자 UUID로 교체):

```sql
-- 사용자 UUID 확인 (Authentication → Users에서 확인)
UPDATE profiles
SET role = 'admin'
WHERE id = '사용자_UUID_여기에_입력';
```

### 관리자 권한 확인

- 로그인 후 사이드바에 **"관리자"** 메뉴가 보이면 admin 권한이 부여된 상태입니다.

---

## 2. 관리자 대시보드 (`/admin`)

### 접근 방법

- 로그인 후 사이드바의 **관리자** 클릭
- 또는 직접 `https://사이트주소/admin` 접속

### 보호 정책

- 로그인한 사용자만 접근 가능
- `profiles.role = 'admin'`인 사용자만 접근 가능
- 관리자가 아니면 자동으로 홈(`/`)으로 이동

### 대시보드 기능

#### 2.1 통계

| 항목       | 설명       |
|------------|------------|
| 총 게시글  | 전체 게시글 수 |
| 총 사용자  | 전체 가입자 수 |

#### 2.2 글 관리 테이블

| 컬럼   | 설명                             |
|--------|----------------------------------|
| 제목   | 글 제목 (클릭 시 상세 페이지로 이동) |
| 작성자 | 표시 이름                        |
| 날짜   | 작성일                           |
| 상태   | 공개 / 숨김                      |
| 관리   | 숨기기, 삭제 버튼                |

---

## 3. 글 관리 기능

### 3.1 숨기기 (Hide)

- **숨기기** 클릭 시 해당 글을 일반 사용자 목록에서 숨김
- 숨긴 글은 작성자와 관리자만 볼 수 있음
- 다시 **공개** 버튼을 누르면 원래대로 표시

### 3.2 공개 (Unhide)

- **공개** 클릭 시 숨긴 글을 다시 목록에 표시

### 3.3 삭제 (Delete)

- **삭제** 클릭 시 확인 후 글을 완전히 삭제
- 삭제된 글과 그에 달린 댓글은 복구 불가

---

## 4. 글 상세 페이지에서의 관리자 기능

관리자는 모든 글 상세 페이지에서 다음을 수행할 수 있습니다.

| 기능     | 설명                         |
|----------|------------------------------|
| 숨기기   | 해당 글을 목록에서 숨김       |
| 공개     | 숨긴 글을 다시 공개           |
| 삭제     | 글 삭제 (작성자 확인 불필요)  |

> **참고**: 수정은 작성자만 가능합니다. 관리자는 숨기기/삭제만 가능합니다.

---

## 5. 카테고리 관리 (DB 직접)

현재 카테고리는 기본 4개(자유게시판, 질문, 정보공유, 후기)가 시드되어 있습니다.

### 카테고리 추가 (Supabase SQL)

```sql
INSERT INTO categories (name, slug)
VALUES ('새카테고리명', 'new-category-slug');
```

### 카테고리 수정

```sql
UPDATE categories
SET name = '변경할이름', slug = 'changed-slug'
WHERE slug = '기존-slug';
```

---

## 6. 관리자 확인 사항

### RLS(Row Level Security) 정책

- `profiles.role = 'admin'`인 경우 posts 테이블 전체 조회·수정·삭제 가능
- 관리자만 숨긴 글(`is_hidden = true`)을 조회 가능

### Storage 버킷

| 버킷        | 제한  | 설명                     |
|-------------|-------|--------------------------|
| avatars     | 1MB   | 프로필 아바타            |
| post-images | 5MB   | 게시글 첨부 이미지       |

> 관리자 권한으로 Storage를 직접 변경하는 기능은 현재 UI에 없습니다.

---

## 7. 문의 및 문제 해결

### 관리자 메뉴가 보이지 않을 때

1. 로그아웃 후 다시 로그인
2. `profiles` 테이블에서 `role = 'admin'` 설정 여부 확인

### 숨긴 글이 다시 보일 때

- `is_hidden`이 `false`로 되돌아간 경우입니다. DB에서 `is_hidden` 값을 확인해 보세요.

---

*마지막 업데이트: 2026-02-01*
